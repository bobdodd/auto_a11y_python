{% extends "base.html" %}

{% block title %}Help & Documentation - Auto A11y{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/help-system.css') }}">
<style>
    .help-section {
        margin-bottom: 40px;
    }
    
    .help-card {
        border-left: 4px solid #3498db;
        margin-bottom: 20px;
        transition: transform 0.2s;
    }
    
    .help-card:hover {
        transform: translateX(5px);
    }
    
    .help-nav {
        position: sticky;
        top: 20px;
    }
    
    .help-nav .nav-link {
        color: #6c757d;
        padding: 8px 15px;
        border-left: 2px solid transparent;
    }
    
    .help-nav .nav-link:hover {
        color: #3498db;
        border-left-color: #3498db;
    }
    
    .help-nav .nav-link.active {
        color: #3498db;
        font-weight: 600;
        border-left-color: #3498db;
        background-color: rgba(52, 152, 219, 0.1);
    }
    
    .score-comparison {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 10px;
        margin-bottom: 30px;
    }
    
    .score-example {
        background-color: white;
        color: #333;
        padding: 20px;
        border-radius: 8px;
        margin-top: 20px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <!-- Navigation Sidebar -->
        <div class="col-md-3">
            <div class="help-nav">
                <h5 class="mb-3">Documentation</h5>
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#scoring">Understanding Scores</a>
                    <a class="nav-link" href="#wcag">WCAG Standards</a>
                    <a class="nav-link" href="#impact">Impact Levels</a>
                    <a class="nav-link" href="#testing">Testing Process</a>
                    <a class="nav-link" href="#reports">Reports & Exports</a>
                    <a class="nav-link" href="#faq">FAQ</a>
                </nav>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="col-md-9">
            <h1 class="mb-4">Help & Documentation</h1>
            
            <!-- Scoring Section -->
            <section id="scoring" class="help-section">
                <h2 class="mb-4">Understanding Your Scores</h2>
                
                <div class="score-comparison">
                    <h3>Why Do I Have Two Different Scores?</h3>
                    <div class="row mt-4">
                        <div class="col-md-6">
                            <h4>📊 Accessibility Score</h4>
                            <p>Measures the percentage of individual checks that passed</p>
                            <ul>
                                <li>Shows progress toward compliance</li>
                                <li>Counts partial successes</li>
                                <li>Good for tracking improvements</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h4>✅ Compliance Score</h4>
                            <p>Measures the percentage of tests with zero violations</p>
                            <ul>
                                <li>Shows true WCAG compliance</li>
                                <li>All-or-nothing per test</li>
                                <li>Used for legal compliance</li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="score-example">
                        <h5>Real Example:</h5>
                        <div class="row">
                            <div class="col-md-4">
                                <strong>Test Results:</strong><br>
                                10 form fields tested<br>
                                9 have proper labels ✓<br>
                                1 missing label ✗
                            </div>
                            <div class="col-md-4">
                                <strong>Accessibility Score:</strong><br>
                                90% (9/10 passed)<br>
                                <span class="text-success">Good progress!</span>
                            </div>
                            <div class="col-md-4">
                                <strong>Compliance Score:</strong><br>
                                0% (test has violations)<br>
                                <span class="text-danger">Not compliant</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="card help-card">
                    <div class="card-body">
                        <h4 class="card-title">Accessibility Score Formula</h4>
                        <code class="d-block p-3 bg-light mb-3">(Passed Checks / Applicable Checks) × 100</code>
                        <p>This score helps you track progress. Each successful check counts toward your score, even if the overall test fails.</p>
                        <ul>
                            <li><strong>90-100%:</strong> Excellent - Minor issues only</li>
                            <li><strong>70-89%:</strong> Good - Some barriers remain</li>
                            <li><strong>50-69%:</strong> Fair - Significant issues</li>
                            <li><strong>Below 50%:</strong> Poor - Major accessibility problems</li>
                        </ul>
                    </div>
                </div>
                
                <div class="card help-card">
                    <div class="card-body">
                        <h4 class="card-title">Compliance Score Formula</h4>
                        <code class="d-block p-3 bg-light mb-3">(Tests with Zero Violations / Total Tests) × 100</code>
                        <p>This score reflects true WCAG compliance. A test passes only if it has zero violations.</p>
                        <ul>
                            <li><strong>100%:</strong> Fully compliant</li>
                            <li><strong>90-99%:</strong> Nearly compliant</li>
                            <li><strong>Below 90%:</strong> Not compliant</li>
                        </ul>
                    </div>
                </div>
            </section>
            
            <!-- WCAG Section -->
            <section id="wcag" class="help-section">
                <h2 class="mb-4">WCAG Standards</h2>
                
                <div class="card help-card">
                    <div class="card-body">
                        <h4 class="card-title">Conformance Levels</h4>
                        <div class="row mt-3">
                            <div class="col-md-4">
                                <h5>Level A</h5>
                                <span class="badge bg-warning text-dark">Minimum</span>
                                <ul class="mt-2">
                                    <li>Basic features</li>
                                    <li>Essential for any site</li>
                                    <li>Alt text, page titles</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <h5>Level AA</h5>
                                <span class="badge bg-success">Recommended</span>
                                <ul class="mt-2">
                                    <li>Legal standard</li>
                                    <li>Removes major barriers</li>
                                    <li>4.5:1 contrast ratio</li>
                                </ul>
                            </div>
                            <div class="col-md-4">
                                <h5>Level AAA</h5>
                                <span class="badge bg-info">Enhanced</span>
                                <ul class="mt-2">
                                    <li>Highest level</li>
                                    <li>Not always required</li>
                                    <li>7:1 contrast ratio</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Impact Levels Section -->
            <section id="impact" class="help-section">
                <h2 class="mb-4">Issue Impact Levels</h2>
                
                <div class="row">
                    <div class="col-md-6">
                        <div class="card help-card border-danger">
                            <div class="card-body">
                                <h4 class="card-title text-danger">🔴 High Impact</h4>
                                <p>Completely blocks access for some users</p>
                                <ul>
                                    <li>Missing alt text on images</li>
                                    <li>No keyboard navigation</li>
                                    <li>Missing form labels</li>
                                </ul>
                                <p class="mb-0"><strong>Action:</strong> Fix immediately</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <div class="card help-card border-warning">
                            <div class="card-body">
                                <h4 class="card-title text-warning">🟡 Medium Impact</h4>
                                <p>Significantly degrades experience</p>
                                <ul>
                                    <li>Poor color contrast</li>
                                    <li>Missing landmarks</li>
                                    <li>Unclear link text</li>
                                </ul>
                                <p class="mb-0"><strong>Action:</strong> Fix soon</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mt-3">
                        <div class="card help-card border-success">
                            <div class="card-body">
                                <h4 class="card-title text-success">🟢 Low Impact</h4>
                                <p>Minor inconvenience</p>
                                <ul>
                                    <li>Redundant alt text</li>
                                    <li>Decorative issues</li>
                                    <li>Minor labeling issues</li>
                                </ul>
                                <p class="mb-0"><strong>Action:</strong> Fix when convenient</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="col-md-6 mt-3">
                        <div class="card help-card border-info">
                            <div class="card-body">
                                <h4 class="card-title text-info">ℹ️ Info/Discovery</h4>
                                <p>Best practices and recommendations</p>
                                <ul>
                                    <li>Optimization opportunities</li>
                                    <li>Manual review items</li>
                                    <li>Not counted in scoring</li>
                                </ul>
                                <p class="mb-0"><strong>Action:</strong> Review for improvements</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Testing Section -->
            <section id="testing" class="help-section">
                <h2 class="mb-4">Testing Process</h2>
                
                <div class="card help-card">
                    <div class="card-body">
                        <h4 class="card-title">Test Applicability</h4>
                        <p>Tests are marked "Not Applicable" when there are no relevant elements on the page.</p>
                        
                        <div class="alert alert-info">
                            <strong>Example:</strong> If a page has no images, the images test will be marked as not applicable and won't affect your score.
                        </div>
                        
                        <p><strong>Benefits:</strong></p>
                        <ul>
                            <li>More accurate scoring</li>
                            <li>No penalties for missing elements</li>
                            <li>Focus on actual issues</li>
                        </ul>
                    </div>
                </div>
                
                <div class="card help-card">
                    <div class="card-body">
                        <h4 class="card-title">Pass Tracking</h4>
                        <p>Our tests track both failures and successes to provide comprehensive feedback.</p>
                        
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Test Component</th>
                                    <th>What It Tracks</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Elements Found</td>
                                    <td>Total elements that could be tested</td>
                                </tr>
                                <tr>
                                    <td>Elements Passed</td>
                                    <td>Elements meeting accessibility standards</td>
                                </tr>
                                <tr>
                                    <td>Elements Failed</td>
                                    <td>Elements with violations</td>
                                </tr>
                                <tr>
                                    <td>Checks Performed</td>
                                    <td>Individual accessibility criteria tested</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <!-- FAQ Section -->
            <section id="faq" class="help-section">
                <h2 class="mb-4">Frequently Asked Questions</h2>
                
                <div class="accordion" id="faqAccordion">
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                Why is my compliance score so much lower than my accessibility score?
                            </button>
                        </h2>
                        <div id="faq1" class="accordion-collapse collapse show">
                            <div class="accordion-body">
                                The compliance score requires perfect passes (zero violations) for each test, while the accessibility score gives credit for partial passes. Even if 90% of your checks pass, a single violation makes that test non-compliant.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                What WCAG level should I aim for?
                            </button>
                        </h2>
                        <div id="faq2" class="accordion-collapse collapse">
                            <div class="accordion-body">
                                Level AA is the recommended target and legal requirement in many jurisdictions. Level A is the absolute minimum, while Level AAA is typically only required for specific content or specialized applications.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                How often should I run accessibility tests?
                            </button>
                        </h2>
                        <div id="faq3" class="accordion-collapse collapse">
                            <div class="accordion-body">
                                Test after every significant change to your site. Set up automated testing in your CI/CD pipeline to catch issues early. Run comprehensive tests at least monthly for active sites.
                            </div>
                        </div>
                    </div>
                    
                    <div class="accordion-item">
                        <h2 class="accordion-header">
                            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq4">
                                What's the difference between automated and manual testing?
                            </button>
                        </h2>
                        <div id="faq4" class="accordion-collapse collapse">
                            <div class="accordion-body">
                                Automated testing (like Auto A11y) can catch about 30-40% of accessibility issues quickly and consistently. Manual testing is needed for subjective criteria like whether alt text is meaningful or if the reading order makes sense. Use both for comprehensive coverage.
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/help-system.js') }}"></script>
<script>
// Smooth scrolling for navigation
document.querySelectorAll('.help-nav .nav-link').forEach(link => {
    link.addEventListener('click', function(e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Update active state
            document.querySelectorAll('.help-nav .nav-link').forEach(l => l.classList.remove('active'));
            this.classList.add('active');
        }
    });
});

// Update active nav on scroll
window.addEventListener('scroll', function() {
    const sections = document.querySelectorAll('.help-section');
    const navLinks = document.querySelectorAll('.help-nav .nav-link');
    
    let current = '';
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= sectionTop - 100) {
            current = section.getAttribute('id');
        }
    });
    
    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) {
            link.classList.add('active');
        }
    });
});
</script>
{% endblock %}