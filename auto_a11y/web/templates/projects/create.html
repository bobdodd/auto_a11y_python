{% extends "base.html" %}

{% block title %}Create Project - Auto A11y{% endblock %}

{% block content %}
<div class="container">
    <div class="row">
        <div class="col-md-8 col-lg-6 mx-auto">
            <h1 class="h2 mb-4">Create New Project</h1>
            
            <div class="card">
                <div class="card-body">
                    <form method="POST" action="{{ url_for('projects.create_project') }}">
                        <div class="mb-3">
                            <label for="name" class="form-label">Project Name *</label>
                            <input type="text" class="form-control" id="name" name="name" 
                                   required autofocus maxlength="100">
                            <div class="form-text">Choose a unique name for your project</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" name="description" 
                                      rows="3" maxlength="500"></textarea>
                            <div class="form-text">Optional description of the project goals</div>
                        </div>
                        
                        <div class="mb-3">
                            <label for="wcag_level" class="form-label">WCAG Compliance Level *</label>
                            <select class="form-select" id="wcag_level" name="wcag_level" required>
                                <option value="AA" selected>Level AA (Recommended)</option>
                                <option value="AAA">Level AAA (Enhanced)</option>
                            </select>
                            <div class="form-text">
                                <strong>Level AA:</strong> Standard compliance (4.5:1 contrast for normal text, 3:1 for large text)<br>
                                <strong>Level AAA:</strong> Enhanced compliance (7:1 contrast for normal text, 4.5:1 for large text)
                            </div>
                        </div>
                        
                        <!-- AI Testing Configuration -->
                        <div class="mb-3">
                            <label class="form-label">AI-Assisted Testing</label>
                            <div class="form-check form-switch mb-2">
                                <input class="form-check-input" type="checkbox" id="enable_ai_testing" name="enable_ai_testing" onchange="toggleAITests()">
                                <label class="form-check-label" for="enable_ai_testing">
                                    Enable AI-assisted accessibility testing
                                </label>
                            </div>
                            <div class="form-text mb-3">
                                AI testing uses Claude to analyze screenshots and HTML for issues that automated tests might miss.
                                <strong>Note:</strong> AI testing incurs API costs based on usage.
                            </div>
                            
                            <div id="ai_tests_selection" style="display: none;">
                                <label class="form-label">Select AI Tests to Run:</label>
                                <div class="ms-3">
                                    <div class="form-check">
                                        <input class="form-check-input ai-test-checkbox" type="checkbox" id="ai_test_headings" name="ai_test_headings" value="headings">
                                        <label class="form-check-label" for="ai_test_headings">
                                            <strong>Heading Analysis</strong> - Detects visual headings not properly marked up
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input ai-test-checkbox" type="checkbox" id="ai_test_reading_order" name="ai_test_reading_order" value="reading_order">
                                        <label class="form-check-label" for="ai_test_reading_order">
                                            <strong>Reading Order</strong> - Verifies logical reading sequence matches visual layout
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input ai-test-checkbox" type="checkbox" id="ai_test_modals" name="ai_test_modals" value="modals">
                                        <label class="form-check-label" for="ai_test_modals">
                                            <strong>Modal Dialogs</strong> - Analyzes popup and overlay accessibility
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input ai-test-checkbox" type="checkbox" id="ai_test_language" name="ai_test_language" value="language">
                                        <label class="form-check-label" for="ai_test_language">
                                            <strong>Language Detection</strong> - Identifies mixed languages and missing declarations
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input ai-test-checkbox" type="checkbox" id="ai_test_animations" name="ai_test_animations" value="animations">
                                        <label class="form-check-label" for="ai_test_animations">
                                            <strong>Animations</strong> - Detects potentially problematic motion
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input ai-test-checkbox" type="checkbox" id="ai_test_interactive" name="ai_test_interactive" value="interactive">
                                        <label class="form-check-label" for="ai_test_interactive">
                                            <strong>Interactive Elements</strong> - Analyzes buttons, links, and form controls
                                        </label>
                                    </div>
                                </div>
                                <div class="form-text mt-2">
                                    <a href="#" onclick="selectAllAITests(event)">Select All</a> | 
                                    <a href="#" onclick="deselectAllAITests(event)">Deselect All</a>
                                </div>
                            </div>
                        </div>
                        
                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle"></i> Create Project
                            </button>
                            <a href="{{ url_for('projects.list_projects') }}" class="btn btn-outline-secondary">
                                <i class="bi bi-x-circle"></i> Cancel
                            </a>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleAITests() {
    const enabled = document.getElementById('enable_ai_testing').checked;
    const selection = document.getElementById('ai_tests_selection');
    selection.style.display = enabled ? 'block' : 'none';
    
    // If disabling, uncheck all tests
    if (!enabled) {
        document.querySelectorAll('.ai-test-checkbox').forEach(cb => {
            cb.checked = false;
        });
    }
}

function selectAllAITests(event) {
    event.preventDefault();
    document.querySelectorAll('.ai-test-checkbox').forEach(cb => {
        cb.checked = true;
    });
}

function deselectAllAITests(event) {
    event.preventDefault();
    document.querySelectorAll('.ai-test-checkbox').forEach(cb => {
        cb.checked = false;
    });
}
</script>
{% endblock %}