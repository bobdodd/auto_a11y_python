<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI_WarnTreeviewWithoutARIA - Correct Usage</title>
    <script type="application/json" id="test-metadata">
{
    "id": "AI_WarnTreeviewWithoutARIA_002_correct_with_aria",
    "issueId": "AI_WarnTreeviewWithoutARIA",
    "expectedViolationCount": 0,
    "expectedPassCount": 1,
    "description": "Tree view navigation with complete ARIA tree pattern",
    "wcag": "1.3.1, 4.1.2",
    "impact": "High"
}
    </script>
    <style>
        .tree { list-style-type: none; padding-left: 0; }
        .tree ul { list-style-type: none; padding-left: 20px; }
        .tree-item { padding: 5px; cursor: pointer; }
        .tree-item:focus { outline: 2px solid #2196F3; background-color: #e3f2fd; }
        .tree-item[aria-expanded]::before { content: '▶ '; display: inline-block; width: 20px; }
        .tree-item[aria-expanded="true"]::before { content: '▼ '; }
        .tree-item[aria-expanded="true"] + ul { display: block; }
        .tree ul { display: none; }
    </style>
    <script>
        function toggleNode(element) {
            const isExpanded = element.getAttribute('aria-expanded') === 'true';
            element.setAttribute('aria-expanded', !isExpanded);
        }

        function handleTreeKeydown(event) {
            const item = event.target;
            const tree = item.closest('[role="tree"]');
            const items = Array.from(tree.querySelectorAll('[role="treeitem"]'));
            const currentIndex = items.indexOf(item);

            switch(event.key) {
                case 'ArrowDown':
                    if (currentIndex < items.length - 1) {
                        items[currentIndex + 1].focus();
                    }
                    event.preventDefault();
                    break;
                case 'ArrowUp':
                    if (currentIndex > 0) {
                        items[currentIndex - 1].focus();
                    }
                    event.preventDefault();
                    break;
                case 'ArrowRight':
                    if (item.hasAttribute('aria-expanded')) {
                        if (item.getAttribute('aria-expanded') === 'false') {
                            toggleNode(item);
                        }
                    }
                    event.preventDefault();
                    break;
                case 'ArrowLeft':
                    if (item.hasAttribute('aria-expanded')) {
                        if (item.getAttribute('aria-expanded') === 'true') {
                            toggleNode(item);
                        }
                    }
                    event.preventDefault();
                    break;
                case 'Enter':
                case ' ':
                    if (item.hasAttribute('aria-expanded')) {
                        toggleNode(item);
                    }
                    event.preventDefault();
                    break;
            }
        }
    </script>
</head>
<body>
    <h1>File Explorer</h1>

    <main>
        <div data-expected-pass="true"
             data-pass-reason="Tree view implemented with complete ARIA tree pattern. Container has role='tree' identifying structure. Tree items have role='treeitem' with proper nesting using role='group'. Parent nodes have aria-expanded indicating collapsed/expanded state. Items use aria-level to indicate nesting depth. Keyboard navigation via arrow keys. Screen readers announce as 'Documents tree item level 1 collapsed'. Users can navigate efficiently and understand hierarchy. Complies with WCAG 1.3.1 Info and Relationships and 4.1.2 Name, Role, Value - proper ARIA tree implementation">
            <ul role="tree" aria-label="File system">
                <li role="none">
                    <div role="treeitem"
                         aria-expanded="false"
                         aria-level="1"
                         tabindex="0"
                         class="tree-item"
                         onclick="toggleNode(this)"
                         onkeydown="handleTreeKeydown(event)">
                        Documents
                    </div>
                    <ul role="group">
                        <li role="none">
                            <div role="treeitem"
                                 aria-level="2"
                                 tabindex="-1"
                                 class="tree-item"
                                 onkeydown="handleTreeKeydown(event)">
                                Resume.pdf
                            </div>
                        </li>
                        <li role="none">
                            <div role="treeitem"
                                 aria-level="2"
                                 tabindex="-1"
                                 class="tree-item"
                                 onkeydown="handleTreeKeydown(event)">
                                CoverLetter.docx
                            </div>
                        </li>
                        <li role="none">
                            <div role="treeitem"
                                 aria-expanded="false"
                                 aria-level="2"
                                 tabindex="-1"
                                 class="tree-item"
                                 onclick="toggleNode(this)"
                                 onkeydown="handleTreeKeydown(event)">
                                Projects
                            </div>
                            <ul role="group">
                                <li role="none">
                                    <div role="treeitem"
                                         aria-level="3"
                                         tabindex="-1"
                                         class="tree-item"
                                         onkeydown="handleTreeKeydown(event)">
                                        Project1.zip
                                    </div>
                                </li>
                                <li role="none">
                                    <div role="treeitem"
                                         aria-level="3"
                                         tabindex="-1"
                                         class="tree-item"
                                         onkeydown="handleTreeKeydown(event)">
                                        Project2.zip
                                    </div>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li role="none">
                    <div role="treeitem"
                         aria-expanded="false"
                         aria-level="1"
                         tabindex="-1"
                         class="tree-item"
                         onclick="toggleNode(this)"
                         onkeydown="handleTreeKeydown(event)">
                        Pictures
                    </div>
                    <ul role="group">
                        <li role="none">
                            <div role="treeitem"
                                 aria-level="2"
                                 tabindex="-1"
                                 class="tree-item"
                                 onkeydown="handleTreeKeydown(event)">
                                Vacation.jpg
                            </div>
                        </li>
                        <li role="none">
                            <div role="treeitem"
                                 aria-level="2"
                                 tabindex="-1"
                                 class="tree-item"
                                 onkeydown="handleTreeKeydown(event)">
                                Family.jpg
                            </div>
                        </li>
                    </ul>
                </li>
                <li role="none">
                    <div role="treeitem"
                         aria-level="1"
                         tabindex="-1"
                         class="tree-item"
                         onkeydown="handleTreeKeydown(event)">
                        Downloads
                    </div>
                </li>
            </ul>
        </div>
    </main>

    <footer>
        <p>&copy; 2024 Company Name. All rights reserved.</p>
    </footer>
</body>
</html>
