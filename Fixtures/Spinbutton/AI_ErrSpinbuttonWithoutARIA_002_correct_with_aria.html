<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI_ErrSpinbuttonWithoutARIA - Correct Usage</title>
    <script type="application/json" id="test-metadata">
{
    "id": "AI_ErrSpinbuttonWithoutARIA_002_correct_with_aria",
    "issueId": "AI_ErrSpinbuttonWithoutARIA",
    "expectedViolationCount": 0,
    "expectedPassCount": 2,
    "description": "Spinbutton/number controls with proper ARIA markup",
    "wcag": "4.1.2",
    "impact": "Medium"
}
    </script>
    <style>
        .spinbutton-container {
            margin: 1rem 0;
        }
        .custom-spinbutton {
            display: inline-flex;
            border: 1px solid #ccc;
        }
        .spin-input {
            width: 60px;
            text-align: center;
            border: none;
            padding: 0.5rem;
        }
        .spin-input:focus {
            outline: 2px solid #007bff;
            outline-offset: -2px;
        }
        .spin-button {
            width: 30px;
            background: #f0f0f0;
            border: none;
            cursor: pointer;
        }
        .spin-button:hover {
            background: #e0e0e0;
        }
    </style>
</head>
<body>
    <h1>Quantity Selector - Correct Usage</h1>

    <main>
        <!-- Custom spinbutton with proper ARIA - CORRECT -->
        <div class="spinbutton-container"
             data-expected-pass="true"
             data-pass-reason="Input has role='spinbutton' with aria-valuenow, aria-valuemin, aria-valuemax, and aria-label. Buttons have aria-label. Full keyboard support with arrow keys">
            <label id="quantity-label">Quantity:</label>
            <div class="custom-spinbutton">
                <button class="spin-button"
                        aria-label="Decrease quantity"
                        onclick="adjustQuantity(-1)">-</button>
                <input type="text"
                       class="spin-input"
                       id="quantity1"
                       role="spinbutton"
                       aria-labelledby="quantity-label"
                       aria-valuenow="1"
                       aria-valuemin="1"
                       aria-valuemax="99"
                       value="1"
                       readonly
                       tabindex="0"
                       onkeydown="handleSpinKeydown(event)">
                <button class="spin-button"
                        aria-label="Increase quantity"
                        onclick="adjustQuantity(1)">+</button>
            </div>
        </div>

        <!-- Native number input with proper labeling - CORRECT -->
        <div class="spinbutton-container"
             data-expected-pass="true"
             data-pass-reason="Number input has associated label via label element and for/id. Min and max constraints provide bounds context to screen readers">
            <label for="age">Age:</label>
            <input type="number"
                   id="age"
                   min="0"
                   max="120"
                   value="25"
                   aria-describedby="age-help">
            <div id="age-help" style="font-size: 0.9em; color: #666;">
                Enter age between 0 and 120
            </div>
        </div>
    </main>

    <script>
        let quantity = 1;
        const input = document.getElementById('quantity1');

        function adjustQuantity(delta) {
            const min = parseInt(input.getAttribute('aria-valuemin'));
            const max = parseInt(input.getAttribute('aria-valuemax'));
            quantity = Math.max(min, Math.min(max, quantity + delta));
            updateSpinbutton();
        }

        function updateSpinbutton() {
            input.value = quantity;
            input.setAttribute('aria-valuenow', quantity);
        }

        function handleSpinKeydown(event) {
            if (event.key === 'ArrowUp') {
                event.preventDefault();
                adjustQuantity(1);
            } else if (event.key === 'ArrowDown') {
                event.preventDefault();
                adjustQuantity(-1);
            } else if (event.key === 'Home') {
                event.preventDefault();
                const min = parseInt(input.getAttribute('aria-valuemin'));
                quantity = min;
                updateSpinbutton();
            } else if (event.key === 'End') {
                event.preventDefault();
                const max = parseInt(input.getAttribute('aria-valuemax'));
                quantity = max;
                updateSpinbutton();
            }
        }
    </script>
</body>
</html>
